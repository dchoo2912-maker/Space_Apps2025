<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mission Vista — Home + Solar System (Single HTML)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --bg: radial-gradient(ellipse at top, #0a0a1a, #000); }
    html, body { height:100%; }
    body { margin:0; background: var(--bg); color:#e6f2ff; font-family:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    .glass { background: rgba(15,15,35,0.6); border: 1px solid rgba(255,255,255,0.09); backdrop-filter: blur(10px); }
    /* 3D canvas fills viewport when in viewer mode */
    #viewerRoot { position: fixed; inset: 0; display: none; }
    #threeMount { position: absolute; inset: 0; }
    #topbar { position: absolute; left:0; right:0; top:0; z-index:10; padding:10px 14px; display:flex; gap:10px; align-items:center;
      background: linear-gradient(180deg, rgba(5,5,20,.85), rgba(5,5,20,.35) 60%, rgba(5,5,20,0)); border-bottom: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(8px); }
    .btn { padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:#eaf6ff; text-decoration:none; }
    a { color:#9ad0ff; text-decoration:none; }
  </style>
  <!-- Three.js + OrbitControls (loaded once; viewer initializes on demand) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
  <!-- HOME SECTION -->
  <div id="homeRoot">
    <header class="sticky top-0 z-20 glass">
      <div class="max-w-6xl mx-auto flex items-center gap-4 px-4 py-3">
        <img src="logo.png" alt="Mission Vista" class="w-10 h-10 rounded-full object-cover" onerror="this.style.display='none'"/>
        <h1 class="text-lg font-semibold">Mission Vista</h1>
        <nav class="ml-auto flex items-center gap-4 text-sm">
          <a class="hover:underline" href="#" onclick="showHome()">Home</a>
          <a class="hover:underline" href="#" onclick="enterSolarSystem()">Solar System</a>
          <a class="hover:underline" href="#projects">Projects</a>
          <a class="hover:underline" href="#about">About</a>
        </nav>
      </div>
    </header>

    <section class="max-w-6xl mx-auto px-4 pt-10 pb-8">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <h2 class="text-3xl md:text-4xl font-semibold leading-tight">Explore NASA Data with an Interactive Solar System</h2>
          <p class="mt-3 text-sky-200/90">Dive into a web‑based 3D model with real textures. Works on GitHub Pages with simple, repo‑local images — no CORS headaches.</p>
          <div class="mt-5 flex gap-3">
            <a href="#" onclick="enterSolarSystem()" class="px-5 py-3 rounded-xl bg-sky-500/90 hover:bg-sky-400 text-black font-semibold">Enter Solar System</a>
            <a href="#setup" class="px-5 py-3 rounded-xl border border-sky-400/50 text-sky-200/90 hover:bg-white/5">How to set up</a>
          </div>
        </div>
        <div class="glass rounded-2xl p-5">
          <h3 class="text-xl font-semibold">What you get</h3>
          <ul class="list-disc pl-5 mt-2 space-y-1 text-sky-100/90">
            <li>Orbiting planets with click‑to‑focus camera</li>
            <li>Local textures from <code class="px-1 rounded bg-white/10">textures/</code> folder</li>
            <li>Single HTML file — deploy anywhere</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="setup" class="max-w-6xl mx-auto px-4 pb-16">
      <div class="glass rounded-2xl p-6">
        <h3 class="text-2xl font-semibold">Setup (GitHub Pages)</h3>
        <ol class="list-decimal pl-5 mt-3 space-y-1 text-sky-100/90">
          <li>Save this file as <b>index.html</b> at the repo root.</li>
          <li>Create a folder <b>textures/</b> and add:
            <code class="px-1 rounded bg-white/10">sun.jpg, mercury.jpg, venus.jpg, earth.jpg, moon.jpg, mars.jpg, jupiter.jpg, saturn.jpg, saturn_ring.png, uranus.jpg, neptune.jpg, stars.jpg</code>
          </li>
          <li>(Optional) add <b>logo.png</b> to the repo root.</li>
          <li>Enable GitHub Pages → Deploy from branch (root), then open your Pages URL.</li>
        </ol>
        <p class="mt-3 text-sky-200/80 text-sm">If you see a black screen, open DevTools → Network → filter <code>textures/</code> and ensure files load (200 OK). Missing files fall back to a solid color so the scene still runs.</p>
      </div>

      <div id="projects" class="mt-10 grid md:grid-cols-3 gap-4">
        <div class="glass rounded-2xl p-5">
          <h4 class="font-semibold">Solar System</h4>
          <p class="text-sky-100/80 text-sm">A Three.js model with real textures and orbits.</p>
          <a class="inline-block mt-3 text-sky-300 hover:underline" href="#" onclick="enterSolarSystem()">Launch →</a>
        </div>
        <div class="glass rounded-2xl p-5">
          <h4 class="font-semibold">Deep Zoom (coming soon)</h4>
          <p class="text-sky-100/80 text-sm">Planetary surfaces with labels & features.</p>
        </div>
        <div class="glass rounded-2xl p-5">
          <h4 class="font-semibold">Data Explorer (coming soon)</h4>
          <p class="text-sky-100/80 text-sm">Query NASA catalogs right in the browser.</p>
        </div>
      </div>
    </section>

    <footer class="border-t border-white/10">
      <div class="max-w-6xl mx-auto px-4 py-6 text-xs text-sky-200/60">© Mission Vista</div>
    </footer>
  </div>

  <!-- VIEWER SECTION (hidden until user enters) -->
  <div id="viewerRoot">
    <div id="threeMount"></div>
    <div id="topbar">
      <a class="btn" href="#" onclick="showHome()">← Home</a>
      <strong>Solar System</strong>
      <span style="opacity:.75">Click a planet to focus • Drag to orbit • Wheel/Pinch to zoom</span>
    </div>
    <div id="hint" class="btn" style="position:absolute; right:12px; bottom:12px; z-index:10;">If it's black, ensure your <code>textures/</code> files exist and names match exactly.</div>
  </div>

  <script>
  // SPA navigation
  function showHome(){
    document.getElementById('homeRoot').style.display='block';
    document.getElementById('viewerRoot').style.display='none';
  }
  function enterSolarSystem(){
    document.getElementById('homeRoot').style.display='none';
    document.getElementById('viewerRoot').style.display='block';
    if(!window.__solarBooted) initSolar();
  }
  // Start at home
  showHome();

  // ---------- 3D Viewer (initialized once) ----------
  function initSolar(){
    window.__solarBooted = true;
    const container = document.getElementById('threeMount');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 10000);
    camera.position.set(0, 20, 70);

    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:false });
    renderer.setPixelRatio(devicePixelRatio);
    renderer.setSize(innerWidth, innerHeight);
    container.appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true; controls.dampingFactor = 0.05; controls.minDistance = 5; controls.maxDistance = 400;

    // Lights
    const hemi = new THREE.HemisphereLight(0x88aaff, 0x080820, 0.25); scene.add(hemi);
    const sunLight = new THREE.PointLight(0xffffff, 2.2, 0, 2); scene.add(sunLight);

    // Textures from repo-local folder
    const loader = new THREE.TextureLoader();
    loader.setPath('textures/');
    const T = (name)=> new Promise(res=> loader.load(name, t=>{t.colorSpace=THREE.SRGBColorSpace; res(t);}, undefined, _=>{console.warn('Missing texture',name); res(null);}));

    (async () => {
      // background
      const stars = await T('stars.jpg');
      if (stars) scene.background = stars; else scene.background = new THREE.Color(0x000000);

      // load planet textures
      const [sunTex, mercuryTex, venusTex, earthTex, moonTex, marsTex, jupiterTex, saturnTex, ringTex, uranusTex, neptuneTex] = await Promise.all([
        T('sun.jpg'), T('mercury.jpg'), T('venus.jpg'), T('earth.jpg'), T('moon.jpg'), T('mars.jpg'), T('jupiter.jpg'), T('saturn.jpg'), T('saturn_ring.png'), T('uranus.jpg'), T('neptune.jpg')
      ]);

      const system = new THREE.Group(); scene.add(system);
      function makePlanet(r, tex, color=0x999999){
        const geo = new THREE.SphereGeometry(r, 64, 64);
        const mat = tex ? new THREE.MeshStandardMaterial({ map: tex, roughness:1, metalness:0 }) : new THREE.MeshStandardMaterial({ color, roughness:1, metalness:0 });
        return new THREE.Mesh(geo, mat);
      }

      // Sun
      const sun = makePlanet(6, sunTex, 0xffcc66); system.add(sun);
      sun.material.emissive = new THREE.Color(0xffffbb); sun.material.emissiveIntensity = 1.0;
      sunLight.position.copy(sun.position);

      // Planets
      const orbitData = [
        { name:'Mercury', r:10, size:.7,  tex:mercuryTex, speed:.02 },
        { name:'Venus',   r:14, size:1.0, tex:venusTex,   speed:.015 },
        { name:'Earth',   r:18, size:1.05, tex:earthTex,  speed:.012, moon:{ size:.28, dist:2.0, tex:moonTex } },
        { name:'Mars',    r:22, size:.9,  tex:marsTex,    speed:.010 },
        { name:'Jupiter', r:30, size:3.2, tex:jupiterTex, speed:.006 },
        { name:'Saturn',  r:38, size:2.8, tex:saturnTex,  speed:.005, ring:true },
        { name:'Uranus',  r:46, size:2.2, tex:uranusTex,  speed:.004 },
        { name:'Neptune', r:54, size:2.1, tex:neptuneTex, speed:.0035 },
      ];

      const planets = [];
      orbitData.forEach(d=>{
        const pivot = new THREE.Group(); system.add(pivot);
        const planet = makePlanet(d.size, d.tex); planet.position.set(d.r,0,0);
        planet.userData = { name:d.name, speed:d.speed, orbitRadius:d.r };
        pivot.add(planet);

        // visual orbit ring
        const ringGeo = new THREE.RingGeometry(d.r-0.01, d.r+0.01, 128);
        const ringMat = new THREE.MeshBasicMaterial({ color:0x223344, side:THREE.DoubleSide, transparent:true, opacity:.35 });
        const ring = new THREE.Mesh(ringGeo, ringMat); ring.rotation.x=-Math.PI/2; system.add(ring);

        if (d.moon){
          const mp = new THREE.Group(); mp.position.copy(planet.position); system.add(mp);
          const moon = makePlanet(d.moon.size, d.moon.tex, 0xbbbbbb); moon.position.set(d.moon.dist,0,0);
          moon.userData = { host: planet, speed: d.speed*6 }; mp.add(moon);
          planet.userData.moonPivot = mp; planet.userData.moon = moon;
        }

        if (d.ring){
          const inner=d.size*1.35, outer=d.size*2.1;
          const geo=new THREE.RingGeometry(inner, outer, 180,1);
          const mat=new THREE.MeshBasicMaterial({ map:ringTex||null, color:ringTex?0xffffff:0xcccccc, transparent:true, opacity:ringTex?1:0.6, side:THREE.DoubleSide });
          const ringMesh=new THREE.Mesh(geo,mat); ringMesh.rotation.x=-Math.PI/2; ringMesh.position.copy(planet.position); system.add(ringMesh);
          planet.userData.saturnRing = ringMesh;
        }

        planets.push({pivot, planet, data:d});
      });

      // Interaction: click to focus
      const ray = new THREE.Raycaster(); const mouse = new THREE.Vector2();
      const clickable = planets.map(p=>p.planet);
      addEventListener('pointerdown', (e)=>{
        if (document.getElementById('viewerRoot').style.display==='none') return; // ignore when hidden
        mouse.x = (e.clientX/innerWidth)*2-1; mouse.y=-(e.clientY/innerHeight)*2+1;
        ray.setFromCamera(mouse, camera);
        const hit = ray.intersectObjects(clickable,false)[0];
        if (hit){
          const target = hit.object; const to = new THREE.Vector3(); target.getWorldPosition(to);
          const dir = new THREE.Vector3().subVectors(camera.position, to).normalize();
          const dist = Math.max(8, target.geometry.parameters.radius*6);
          const newPos = to.clone().add(dir.multiplyScalar(dist));
          smoothCam(camera.position.clone(), newPos, to);
        }
      });

      function smoothCam(from, toPos, lookAt){
        const start = performance.now(); const dur = 800;
        (function step(now){ const t = Math.min(1,(now-start)/dur); camera.position.lerpVectors(from,toPos,t); controls.target.lerp(lookAt,t); if(t<1) requestAnimationFrame(step); })(start);
      }

      // Loop
      const clock = new THREE.Clock();
      function tick(){
        const t = clock.getElapsedTime();
        planets.forEach(({pivot, planet, data})=>{
          pivot.rotation.y = t*data.speed; // orbit
          planet.rotation.y += 0.01;       // spin
          if(planet.userData.moonPivot) planet.userData.moonPivot.rotation.y = t*(data.speed*6);
          if(planet.userData.saturnRing) planet.userData.saturnRing.rotation.z = 0.2; // tilt
        });
        controls.update();
        renderer.render(scene, camera);
        requestAnimationFrame(tick);
      }
      tick();
    })();

    // Resize handler (active regardless of section visibility)
    addEventListener('resize', ()=>{
      const canvasShown = document.getElementById('viewerRoot').style.display !== 'none';
      // Always update camera/renderer sizes so coming back is instant
      if (canvasShown) {
        camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix();
        renderer.setSize(innerWidth, innerHeight);
      } else {
        // Still keep renderer size in sync to avoid a flash when showing again
        renderer.setSize(innerWidth, innerHeight);
        camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix();
      }
    });
  }
  </script>
</body>
</html>


