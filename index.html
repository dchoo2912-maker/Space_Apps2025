<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mission Vista ‚Äî Solar System Explorer</title>

<!-- Tailwind (UI only) -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<!-- Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<!-- OpenSeadragon (for the simple deep-zoom tab) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.1/openseadragon.min.css" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.1/openseadragon.min.js" crossorigin="anonymous"></script>

<style>
:root{--bg:#0b1020;--panel:#111936;--ink:#eaf2ff;--muted:#9fb0d3;--accent:#7cc7ff;--glass:rgba(20,20,40,.6)}
html,body{height:100%;margin:0;background: radial-gradient(100% 80% at 50% 0%, #0a0a20 0%, #000 80%);color:var(--ink);font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial}
a,a:visited{color:#89d4ff}
header{backdrop-filter:blur(10px);background-color:rgba(10,10,30,0.4);position:sticky;top:0;z-index:50;}
.starfield{position:fixed;inset:0;z-index:-10;background:radial-gradient(circle at 50% 20%,#1a1a3d,#000);background-size:cover;animation:stars 200s linear infinite;}
@keyframes stars{from{background-position:0 0;}to{background-position:10000px 10000px;}}
.glow-text{background:linear-gradient(90deg,#70b8ff,#b597ff);-webkit-background-clip:text;color:transparent;animation:glow 3s ease-in-out infinite alternate;}
@keyframes glow{from{text-shadow:0 0 10px #70b8ff44;}to{text-shadow:0 0 25px #b597ffaa;}}
.hero-btn{background:linear-gradient(90deg,#3b82f6,#1e40af);color:#fff;padding:1rem 3rem;border-radius:9999px;font-size:1.1rem;font-weight:600;transition:all .3s;box-shadow:0 0 20px #3b82f655,0 0 40px #1e40af33;}
.hero-btn:hover{transform:scale(1.06);box-shadow:0 0 25px #3b82f6aa,0 0 60px #1e40afaa;background:linear-gradient(90deg,#2563eb,#1d4ed8);}
.glass{background:var(--glass);backdrop-filter:blur(8px);border:1px solid rgba(120,120,200,.15)}
.btn{padding:.45rem .65rem;border-radius:.75rem;font-size:.85rem;background:rgba(120,130,255,.14);border:1px solid rgba(120,130,255,.25);line-height:1}
.btn:hover{background:rgba(120,130,255,.22)}
.btn-primary{background:rgba(123,140,255,.25);border-color:rgba(123,140,255,.5)}
.nav-top-fix{z-index:9999!important;pointer-events:auto!important;}
#planet-canvas{width:100%;height:100%;display:block}
#planet-hud{position:absolute;left:12px;bottom:12px;color:var(--muted);font-size:12px}
#viewer{position:absolute;inset:0;z-index:10;}
#inspectOverlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;z-index:99999;}
#inspectPanel{width:min(92vw,1100px);height:min(86vh,720px);background:#0a0f24;border:1px solid rgba(255,255,255,.12);border-radius:16px;display:flex;flex-direction:column;}
#inspectHeader{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid rgba(255,255,255,.12);}
#inspectHeader .title{font-weight:700;}
#inspectBody{flex:1;position:relative;background:#000;border-radius:0 0 16px 16px;overflow:hidden;}
#inspectCanvas{position:absolute;inset:0;}
#localModeBtn{position:fixed;top:16px;right:16px;z-index:10000;}
</style>
</head>
<body>
<div class="starfield"></div>

<!-- LOCAL MODE TOGGLE -->
<button id="localModeBtn" class="btn">Local Mode: <span id="localModeState">OFF</span></button>

<header class="p-6 flex justify-between items-center">
  <h1 class="text-2xl font-bold tracking-wider glow-text">MISSION VISTA</h1>
  <nav class="space-x-6">
    <button data-goto="home" class="hover:text-blue-400" aria-label="Home">Home</button>
    <button data-goto="explorer" class="hover:text-blue-400" aria-label="Solar System">Solar System</button>
  </nav>
</header>

<main id="home" class="block">
  <section class="min-h-screen flex flex-col items-center justify-center text-center px-6">
    <h2 class="text-5xl md:text-6xl font-bold mb-6 glow-text">See Beyond Pixels</h2>
    <p class="max-w-2xl text-lg text-gray-300 mb-10">
      Your phone captures millions of pixels. NASA captures trillions.<br/>
      <span class="text-blue-400">Mission Vista</span> transforms real NASA datasets into immersive visual experiences.
    </p>
    <button data-goto="explorer" class="hero-btn" aria-label="Enter the Solar System">üöÄ Enter the Solar System ‚Üí</button>
  </section>
  <section class="py-24 bg-black/30">
    <div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-12 items-center px-6">
      <div class="text-left space-y-6">
        <h3 class="text-3xl font-semibold mb-2">Our Project</h3>
        <p>Click <em>Solar System</em> to try our two modes: <span class="font-semibold">3D Planets</span> and a minimal <span class="font-semibold">Deep Zoom</span> viewer.</p>
        <div><button data-goto="explorer" class="btn mt-2">Open the Solar System Explorer ‚Üí</button></div>
      </div>
    </div>
  </section>
</main>

<section id="explorer" class="hidden relative">
  <div class="glass fixed top-3 left-1/2 -translate-x-1/2 nav-top-fix rounded-2xl px-3 py-2 z-[9999] flex items-center gap-3">
    <button data-goto="home" class="btn" title="Back to Home">‚Üê Home</button>
    <div class="font-semibold tracking-wide">Space Explorer</div>
    <div class="ml-2 flex gap-2">
      <button id="tabPlanets" class="btn btn-primary">3D Planets</button>
      <button id="tabZoom" class="btn">Deep Zoom</button>
    </div>
    <div class="ml-2 flex items-center gap-2">
      <label class="text-xs opacity-80" for="bodySelect">Body</label>
      <select id="bodySelect" class="bg-transparent border border-slate-600 rounded-xl p-1 px-2 text-xs">
        <option>Mercury</option><option>Venus</option><option>Earth</option><option>Mars</option>
        <option>Jupiter</option><option selected>Saturn</option><option>Uranus</option><option>Neptune</option>
      </select>
    </div>
    <button id="inspectBtn" class="btn hidden">Inspect</button>
    <button id="stopFollowBtn" class="btn hidden">Stop following</button>
  </div>

  <!-- 3D Planets view -->
  <div class="w-full h-screen grid grid-cols-1" id="view-planets">
    <div id="planet-wrap" class="relative">
      <canvas id="planet-canvas"></canvas>
      <div id="planet-hud">Drag = orbit ‚Ä¢ Scroll = zoom ‚Ä¢ Double-click empty space to reset</div>
      <div id="chooser" class="absolute top-4 right-4 z-20 flex gap-2 flex-wrap max-w-[50vw]"></div>
      <div class="absolute top-4 left-4 z-20 text-sm opacity-90 bg-black/40 px-3 py-2 rounded-xl border border-white/10">
        <div id="planetName" class="font-semibold">Click a planet or Moon</div>
        <div id="stats" class="text-xs opacity-90"></div>
      </div>
    </div>
  </div>

  <!-- Deep Zoom view -->
  <div class="w-full h-screen relative overflow-hidden hidden" id="view-zoom">
    <div class="glass absolute left-3 top-16 bottom-3 w-64 z-30 rounded-2xl p-3 flex flex-col gap-3">
      <div class="text-sm font-semibold mb-1">Layers</div>
      <div class="grid grid-cols-1 gap-2">
        <button class="btn btn-primary" data-layer="earth">Blue Marble</button>
        <button class="btn" data-layer="mars">Mars (Viking)</button>
        <button class="btn" data-layer="moon">Moon (LRO)</button>
      </div>
      <hr class="border-slate-700/50 my-1">
      <div class="text-[11px] opacity-70">Drag to move ‚Ä¢ Scroll to zoom</div>
    </div>
    <div id="viewer"></div>
  </div>
</section>

<footer class="p-6 text-center text-gray-500 text-sm">
  Built for the NASA Space Apps Challenge üöÄ
</footer>

<!-- OrbitControls-lite (inline) -->
<script>
class OrbitControlsLite {
  constructor(object, domElement){
    this.object = object; this.domElement = domElement || document; this.enabled = true;
    this.target = new THREE.Vector3(); this.enablePan = false; this.enableDamping = true; this.dampingFactor = 0.06;
    this.minDistance = 5; this.maxDistance = 900; this.rotateSpeed = 0.0022; this.zoomSpeed = 1.1;
    this._spherical = new THREE.Spherical(); this._sphericalDelta = new THREE.Spherical(0,0,0);
    this._offset = new THREE.Vector3(); this._state='none'; this._pointer=new THREE.Vector2(); this._pointerOld=new THREE.Vector2();
    this._phiMin = 1e-3; this._phiMax = Math.PI - 1e-3;
    this._onMouseDown=(e)=>{ if(!this.enabled) return; if(e.button===0){ this._state='rotate'; this._pointer.set(e.clientX,e.clientY); this._pointerOld.copy(this._pointer); this.domElement.setPointerCapture?.(e.pointerId);} };
    this._onMouseMove=(e)=>{ if(!this.enabled) return; if(this._state==='rotate'){ this._pointer.set(e.clientX,e.clientY);
      const dx=this._pointer.x-this._pointerOld.x, dy=this._pointer.y-this._pointerOld.y;
      this._sphericalDelta.theta -= dx*this.rotateSpeed; this._sphericalDelta.phi -= dy*this.rotateSpeed;
      this._pointerOld.copy(this._pointer);} };
    this._onMouseUp=()=>{ this._state='none'; };
    this._onWheel=(e)=>{ if(!this.enabled) return; e.preventDefault(); const s=(e.deltaY<0)?(1/this.zoomSpeed):this.zoomSpeed; this._zoom(s); };
    this.domElement.addEventListener('pointerdown', this._onMouseDown, {passive:false});
    window.addEventListener('pointermove', this._onMouseMove, {passive:false});
    window.addEventListener('pointerup', this._onMouseUp, {passive:false});
    this.domElement.addEventListener('wheel', this._onWheel, {passive:false});
    this._updateSphericalFromObject();
  }
  _updateSphericalFromObject(){ this._offset.copy(this.object.position).sub(this.target); this._spherical.setFromVector3(this._offset);
    this._spherical.radius = Math.min(Math.max(this._spherical.radius, this.minDistance), this.maxDistance); }
  _zoom(scale){ this._spherical.radius*=scale; this._spherical.radius=Math.min(Math.max(this._spherical.radius,this.minDistance),this.maxDistance); }
  update(){
    if(this.enableDamping){
      this._spherical.theta += this._sphericalDelta.theta*this.dampingFactor;
      this._spherical.phi   += this._sphericalDelta.phi  *this.dampingFactor;
      this._sphericalDelta.theta *= (1-this.dampingFactor);
      this._sphericalDelta.phi   *= (1-this.dampingFactor);
    }else{
      this._spherical.theta += this._sphericalDelta.theta;
      this._spherical.phi   += this._sphericalDelta.phi;
      this._sphericalDelta.set(0,0,0);
    }
    this._spherical.phi = Math.max(this._phiMin, Math.min(this._phiMax, this._spherical.phi));
    this._spherical.radius = Math.min(Math.max(this._spherical.radius, this.minDistance), this.maxDistance);
    this._offset.setFromSpherical(this._spherical); this.object.position.copy(this.target).add(this._offset); this.object.lookAt(this.target);
  }
  dispose(){
    this.domElement.removeEventListener('pointerdown', this._onMouseDown);
    window.removeEventListener('pointermove', this._onMouseMove);
    window.removeEventListener('pointerup', this._onMouseUp);
    this.domElement.removeEventListener('wheel', this._onWheel);
  }
}
THREE.EventDispatcher && Object.assign(OrbitControlsLite.prototype, THREE.EventDispatcher.prototype);
THREE.OrbitControls = OrbitControlsLite;
</script>

<script>
// --- Local Mode Toggle ---
let LOCAL_MODE = location.protocol === "file:";
const localBtn = document.getElementById('localModeBtn');
const localState = document.getElementById('localModeState');
function updateLocalBtn() {
  localState.textContent = LOCAL_MODE ? "ON" : "OFF";
  localBtn.classList.toggle('btn-primary', LOCAL_MODE);
}
localBtn.onclick = function() {
  LOCAL_MODE = !LOCAL_MODE;
  updateLocalBtn();
  location.reload(); // reload to re-apply textures
};
updateLocalBtn();

// --- Texture sources ---
const TEXSRC_REMOTE = {
  mercury: ["https://upload.wikimedia.org/wikipedia/commons/2/2c/Mercury_global_map_MESSENGER_mosaic_enhanced_color.jpg"],
  venus:   ["https://upload.wikimedia.org/wikipedia/commons/8/85/Venus_RGB_Map_1800x900.jpg"],
  earth:   ["https://upload.wikimedia.org/wikipedia/commons/5/5f/Blue_Marble_2002.png"],
  moon:    ["https://upload.wikimedia.org/wikipedia/commons/5/5e/Moon_map_LRO_WAC_Poles_1k.jpg"],
  mars:    ["https://upload.wikimedia.org/wikipedia/commons/0/02/Mars_Viking_MDIM21_1km_plus_poles.jpg"],
  jupiter: ["https://upload.wikimedia.org/wikipedia/commons/5/5a/Jupiter_map_by_Askaniy.jpg"],
  saturn:  ["https://upload.wikimedia.org/wikipedia/commons/f/f0/Saturn_map_by_Askaniy.png"],
  uranus:  ["https://upload.wikimedia.org/wikipedia/commons/3/3d/Solarsystemscope_texture_2k_uranus.jpg"],
  neptune: ["https://upload.wikimedia.org/wikipedia/commons/5/56/Solarsystemscope_texture_2k_neptune.jpg"]
};
const TEXSRC_LOCAL = {
  mercury: ["textures/mercury.jpg"],
  venus:   ["textures/venus.jpg"],
  earth:   ["textures/earth.jpg"],
  moon:    ["textures/moon.jpg"],
  mars:    ["textures/mars.jpg"],
  jupiter: ["textures/jupiter.jpg"],
  saturn:  ["textures/saturn.jpg"],
  uranus:  ["textures/uranus.jpg"],
  neptune: ["textures/neptune.jpg"]
};
function textureCandidatesFor(key) {
  return LOCAL_MODE ? (TEXSRC_LOCAL[key]||[]) : (TEXSRC_REMOTE[key]||[]);
}

// --- The rest of your Mission Vista code goes here ---
// (Paste your full Mission Vista JS, replacing any use of TEXSRC with textureCandidatesFor(key))
// (See previous answers for the full code block.)
// For brevity, not repeating the entire code here, but you can copy-paste your main JS logic below this point.

</script>
</body>
</html>

